I"–F<blockquote>
  <p>â€œYeah Itâ€™s leetcode problem. â€</p>
</blockquote>

<h2 id="é—®é¢˜æè¿°">é—®é¢˜æè¿°</h2>

<p>é—®é¢˜æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯ç»™ä½ ä¸€ä¸ªç”±ï¼ˆï¼‰è¿™ä¸¤ä¸ªå­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œæ±‚å…¶ä¸­æœ‰æ•ˆçš„æ‹¬å·ç»„æˆçš„å­—ç¬¦ä¸²çš„æœ€é•¿é•¿åº¦ã€‚</p>

<p>Given a string containing just the characters â€˜(â€˜ and â€˜)â€™, find the length of the longest valid (well-formed) parentheses substring.</p>

<p><strong>Example:</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>Input: ")()())"
Output: 4
Explanation: The longest valid parentheses substring is "()()"
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>Note:</strong></p>

<p>è¿™ç§é—®é¢˜å§ï¼Œä¸€çœ‹æ±‚æœ‰æ•ˆéƒ¨åˆ†çš„æœ€å¤§é•¿åº¦ï¼Œç¬¬ä¸€ååº”å°±åº”è¯¥æ˜¯DPäº†ï¼Œä¸è¿‡è¿™ä¸ªé¢˜æœ€å¼€å§‹æ²¡æƒ³å¥½æ€ä¹ˆDPï¼Œ å°±å¡ä½äº†ï¼Œæ‰€ä»¥ç°åœ¨è®°ä½è¿™é¢˜DPçš„æ–¹æ³•ï¼ï¼ï¼ è°¢è°¢ï¼ï¼</p>

<p>å¦å¤– è¿™ä¸ªé¢˜è¿˜å¯ä»¥ç”¨stack å’Œä¸€ç§æ¯”è¾ƒç¥å¥‡çš„æ€è·¯å»åšï¼Œstackå¯ä»¥äº†è§£ä¸€ä¸‹ï¼Œé‚£ä¸ªæ¯”è¾ƒç¥å¥‡çš„æ–¹æ³•çœ‹çœ‹èƒ½è®°ä½å°±è¡Œå•¦ã€‚DPçš„ä¸€å®šè¦è®°ä½ï¼</p>

<h2 id="dp">DP</h2>

<p>è¿™ä¸ªé¢˜çš„DPæ€è·¯æ˜¯è¿™æ ·çš„ï¼šæ„å»ºä¸€ä¸ªdpæ•°ç»„ï¼Œé‡Œé¢å­˜çš„å†…å®¹ dp[i] æ˜¯<strong>ä»0åˆ°içš„æœ€é•¿æœ‰æ•ˆé•¿åº¦</strong>ã€‚èƒ½æƒ³åˆ°è¿™ä¸€ç‚¹ï¼Œå…¶å®åº•ä¸‹å°±å¥½åŠäº†ä¸€ç‚¹ã€‚</p>

<p>å¦‚æœs[i]ä¸ºâ€˜ï¼ˆ â€™ï¼Œ é‚£ä¹ˆdp[i]å°±ä¸º0ã€‚</p>

<p>å¦‚æœs[i]ä¸ºâ€˜)â€™  é‚£ä¹ˆå¦‚æœs[i-1]ä¸ºâ€˜ï¼ˆ â€™ï¼Œä¹Ÿå°±æ˜¯è¯´æ˜¯â€œâ€¦()â€¦â€ è¿™æ ·çš„å½¢å¼ï¼Œé‚£dp[i]=2+dp[i-2]</p>

<p>â€‹					 å¦‚æœs[i-1] ä¸ºâ€˜ ï¼‰â€™ï¼Œ å°±æ˜¯â€œâ€¦))â€¦â€ è¿™æ ·çš„å½¢å¼ï¼Œè¿™ä¸ªå°±æœ‰ç‚¹å¤æ‚å•¦ï¼Œæˆ‘ä»¬è¦å†å¾€å‰é¢è€ƒè™‘ä¸€ä¸‹ï¼Œå¦‚æœå‰é¢èƒ½æ‰¾åˆ°ï¼ˆï¼ˆâ€¦ï¼‰ï¼‰è¿™ç§å½¢å¼ï¼Œå…¶ä¸­ç¬¬äºŒä¸ªï¼ˆ æ˜¯s[i-1]é‚£ä¸ªæ‹¬å·çš„æœ€é•¿æœ‰æ•ˆå¯¹åº”çš„å·¦æ‹¬å·ï¼Œå¦‚æœè¿™ä¸ªå·¦æ‹¬å·å·¦è¾¹è¿˜æ˜¯å·¦æ‹¬å·ï¼Œé‚£è¿™ä¸ªå°±èƒ½æ„æˆä¸€ä¸ªæœ‰æ•ˆçš„å­—ç¬¦ä¸²å•¦ï¼Œç¬¬ä¸€ä¸ªå·¦æ‹¬å·çš„ä½ç½®ä¸ºi-1-dp[i-1]ã€‚ æ‰€ä»¥æˆ‘ä»¬å†åˆ¤æ–­ä¸€ä¸‹è¿™ä¸ªï¼ŒåŒæ—¶ï¼Œè¯´ä¸å®šè¿˜èƒ½è·Ÿå†å‰é¢ä¸€ä¸ªæœ‰æ•ˆçš„ç»ƒèµ·æ¥ï¼Œæ‰€ä»¥æ»¡è¶³è¿™äº›æ¡ä»¶çš„æ—¶å€™dp[i]=dp[i - dp[i - 1] - 2]+2+dp[i-1]ã€‚</p>

<p>æ³¨æ„ï¼š ä»£ç çš„æ—¶å€™ï¼Œè¦æ³¨æ„èŒƒå›´ï¼Œä¾‹å¦‚i-2ä¹‹ç±»çš„ï¼Œå…ˆåˆ¤æ–­ä¸€ä¸‹æœ‰æ²¡æœ‰è¶…å‡ºèŒƒå›´ï¼Œè¶…å‡ºèŒƒå›´äº†å°±è¦å¦å†™ä¸€ä¸‹ã€‚è¿™æ˜¯æˆ‘å®ç°çš„æ—¶å€™æ²¡æœ‰æ³¨æ„åˆ°çš„ã€‚</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="rouge-code"><pre><span class="cp">#include &lt;stack&gt;
</span><span class="k">class</span> <span class="nc">Solution</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="kt">int</span> <span class="n">longestValidParentheses</span><span class="p">(</span><span class="n">string</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// way 1 DP</span>
        <span class="k">if</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">){</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kt">int</span> <span class="n">re</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">dp</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="sc">')'</span><span class="p">){</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="sc">')'</span><span class="p">){</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">==</span><span class="sc">'('</span><span class="p">){</span>
                        <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">((</span><span class="n">i</span> <span class="o">-</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">?</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">else</span><span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span>
                        <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">;</span>
                    <span class="k">else</span>
                        <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="n">re</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">re</span><span class="p">,</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">re</span><span class="p">;</span>      
    <span class="p">}</span>
<span class="p">};</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="stack">Stack</h2>

<p>è¿™ç§æ–¹æ³•å‘¢ï¼Œå°±æ¯”è¾ƒè€ƒé€»è¾‘æ€ç»´å•¦ã€‚ç›´æ¥çœ‹solutionçš„å›¾å§<a href="https://leetcode.com/problems/longest-valid-parentheses/solution/">solution</a></p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="cp">#include &lt;stack&gt;
</span><span class="k">class</span> <span class="nc">Solution</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="kt">int</span> <span class="n">longestValidParentheses</span><span class="p">(</span><span class="n">string</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// way 2 stack</span>
        <span class="n">stack</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">sta</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">maxAns</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">sta</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span>  <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="sc">'('</span><span class="p">){</span>
                <span class="n">sta</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span><span class="p">{</span>
                <span class="n">sta</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">sta</span><span class="p">.</span><span class="n">empty</span><span class="p">()){</span>
                    <span class="n">sta</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">else</span><span class="p">{</span>
                    <span class="n">maxAns</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">maxAns</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="n">sta</span><span class="p">.</span><span class="n">top</span><span class="p">());</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span> 
        <span class="k">return</span> <span class="n">maxAns</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="two-passèŠ‚çœäº†ç©ºé—´-åªç”¨äº†o1">two pass(èŠ‚çœäº†ç©ºé—´ åªç”¨äº†o(1))</h2>

<p>è¿™ç§æ–¹æ³•å‘¢ï¼Œæˆ‘æ˜¯ç¬¬ä¸€æ¬¡æƒ³ä¸åˆ°ï¼Œä¸è¿‡å¯ä»¥è®°ä½ï¼Œé¢è¯•å®˜é—®åˆ°å‡å°‘ç©ºé—´å¤æ‚åº¦å¯ä»¥å›ç­”<a href="https://leetcode.com/problems/longest-valid-parentheses/solution/">solution</a></p>

<p>æ€è·¯ï¼šå…ˆä»å·¦å¾€å³éå†ä¸€æ¬¡ï¼Œå¦‚æœå·¦æ‹¬å·ä¸ªæ•°å¤§äºå³æ‹¬å·ä¸ªæ•°ï¼Œä¸ç”¨ç®¡ï¼Œå¦‚æœç›¸ç­‰äº†ï¼Œä»£è¡¨æ‰¾åˆ°äº†ä¸€ä¸ªé…å¯¹ï¼Œæ­¤æ—¶len=ä¸¤è€…ä¸ªæ•°ã€‚å¦‚æœå°äºäº†ï¼Œå°±ä»£è¡¨è¿åè§„åˆ™äº†ï¼Œä¸¤è€…ç½®0æ¥ç€åˆ¤æ–­ã€‚</p>

<p>ä½†æ˜¯è¿˜éœ€è¦ä»å³å¾€å·¦æ¥ä¸€æ¬¡ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Œä¾‹å¦‚ï¼ˆï¼ˆï¼‰ ç”±äºæ‹¬å·çš„ä¸ªæ•°ä¸æ˜¯å¶æ•°ï¼Œå·¦æ‹¬å·å³æ‹¬å·ä¸ªæ•°ä¸ç›¸ç­‰ï¼Œå¦‚æœåªä»å·¦å¾€å³å°±ä¼šé”™è¿‡ï¼ˆï¼‰ï¼Œæ‰€ä»¥è¦ä»å³å¾€å·¦å†æ¥ä¸€æ¬¡ã€‚</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre></td><td class="rouge-code"><pre><span class="cp">#include &lt;stack&gt;
</span><span class="k">class</span> <span class="nc">Solution</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="kt">int</span> <span class="n">longestValidParentheses</span><span class="p">(</span><span class="n">string</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// way 3 Inspiration ä¸€ä¸ªå¾ˆç¥å¥‡çš„è§£æ³•</span>
        <span class="kt">int</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">maxAns</span><span class="p">;</span>
	    <span class="n">left</span> <span class="o">=</span> <span class="n">right</span> <span class="o">=</span> <span class="n">maxAns</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="sc">'('</span><span class="p">)</span>
                <span class="n">left</span><span class="o">++</span><span class="p">;</span>          
            <span class="k">else</span>
                <span class="n">right</span><span class="o">++</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">left</span><span class="o">==</span><span class="n">right</span><span class="p">){</span>
                <span class="n">maxAns</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">maxAns</span><span class="p">,</span> <span class="n">left</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">right</span><span class="o">&gt;</span><span class="n">left</span><span class="p">){</span>
                <span class="n">left</span><span class="o">=</span><span class="n">right</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">left</span><span class="o">=</span><span class="n">right</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">){</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="sc">'('</span><span class="p">)</span>
                <span class="n">left</span><span class="o">++</span><span class="p">;</span>          
            <span class="k">else</span>
                <span class="n">right</span><span class="o">++</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">left</span><span class="o">==</span><span class="n">right</span><span class="p">){</span>
                <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">left</span><span class="p">;</span>
                <span class="n">maxAns</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">maxAns</span><span class="p">,</span> <span class="n">left</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">right</span><span class="o">&lt;</span><span class="n">left</span><span class="p">){</span>
                <span class="n">left</span><span class="o">=</span><span class="n">right</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">maxAns</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></td></tr></tbody></table></code></pre></div></div>
:ET